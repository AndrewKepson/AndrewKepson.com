---
import { getCollection } from "astro:content";
import ArchiveLayout from "@components/layouts/archive-layout/archive-layout.astro";
import { allWordPressPosts } from "@lib/store";
import slugger from "slugger";

export async function getStaticPaths() {
	const allWordPressCategories = await getCollection("categories");

	return allWordPressCategories.map((category) => ({
		params: {
			category: slugger(category?.data?.name),
		},
		props: {
			category,
			posts: allWordPressPosts.filter((post) => post?.category === category?.data?.name),
		},
	}));
}

const { category, posts } = Astro.props;
---

<ArchiveLayout
	title={`Blog Posts About ${category?.data?.name}`}
	description={`Read articles about ${category?.data?.name} written by Andrew Kepson.`}
	canonical={category?.data?.uri}
	posts={posts}
	category={category?.data?.name}
/>
