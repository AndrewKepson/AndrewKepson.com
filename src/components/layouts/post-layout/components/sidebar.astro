---
import type { BlogPost } from "@lib/types";
import { getHeadingsFromMarkdown } from "@lib/functions";

interface Props {
	post: BlogPost["data"];
}

const { post } = Astro.props;
const headings = getHeadingsFromMarkdown(post?.content);
---

<aside class="sticky top-24 hidden h-fit space-y-12 self-start lg:block" data-pg-collapsed>
	<!-- Table of Contents -->
	<nav class="space-y-4" aria-label="Table of Contents">
		<h2 class="font-display text-secondary-500 text-xl font-semibold">On This Page</h2>
		<ul class="font-body text-ink-400 space-y-2 text-sm leading-relaxed">
			{
				headings.map((heading) => (
					<li>
						<a href={`#${heading.slug}`} class="hover:text-quaternary-700 underline-hover">
							{heading.heading}
						</a>
					</li>
				))
			}
		</ul>
	</nav>

	<!-- Subscribe -->
	<div class="space-y-4">
		<h2 class="font-display text-secondary-500 text-xl font-semibold">Stay in the Conversation</h2>
		<p class="font-body text-ink-400 text-sm leading-relaxed">
			Thoughtful essays on culture, virtue, and design â€” sent occasionally, never spammed.
		</p>
		<form class="max-w-full space-y-3">
			<input
				type="email"
				placeholder="Your email"
				class="bg-offwhite-500 border-secondary-200 focus:border-quaternary-400 focus:ring-quaternary-400 font-body placeholder-ink-300 text-ink-500 w-full max-w-full rounded-[6px] border px-4 py-3 text-sm focus:ring-2 focus:outline-none"
			/>
			<button type="submit" class="button-base theme-transition button-secondary w-full"> Subscribe </button>
		</form>
	</div>
	<!-- Related Posts -->
	<div class="border-secondary-200 space-y-4 border-t pt-12">
		<h3 class="font-display text-secondary-500 text-lg font-semibold">Related Essays</h3>
		<ul class="font-body text-ink-400 space-y-3 text-sm">
			<li><a href="#" class="hover:text-quaternary-700 underline-hover block">The Silence Between Ideas</a></li>
			<li><a href="#" class="hover:text-quaternary-700 underline-hover block">The Ethics of Simplicity</a></li>
			<li><a href="#" class="hover:text-quaternary-700 underline-hover block">On the Limits of Progress</a></li>
			<li><a href="#" class="hover:text-quaternary-700 underline-hover block">The Geometry of Thought</a></li>
		</ul>
	</div>
</aside>
